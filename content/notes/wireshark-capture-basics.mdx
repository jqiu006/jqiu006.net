---
title: "Wireshark Packet Capture Fundamentals"
date: "2024-02-10"
tags: ["Wireshark", "Network Analysis", "Troubleshooting"]
summary: "Essential Wireshark techniques for network packet analysis, filtering, and troubleshooting common network issues."
---

# Wireshark Packet Capture Fundamentals

Wireshark is an essential tool for network analysis and troubleshooting. This guide covers the fundamentals of packet capture and analysis.

## Getting Started with Captures

### Basic Capture Setup

1. **Select Interface**: Choose the correct network interface
2. **Set Filters**: Apply capture filters to reduce noise
3. **Start Capture**: Begin packet collection
4. **Stop and Save**: Save captures for analysis

```bash
# Command line capture with tshark
tshark -i eth0 -w capture.pcap -f "host 192.168.1.1"
```

### Capture Filters vs Display Filters

**Capture Filters** (applied during capture):
- `host 192.168.1.1` - Capture traffic to/from specific host
- `port 80` - Capture HTTP traffic only
- `tcp and port 443` - Capture HTTPS traffic

**Display Filters** (applied after capture):
- `ip.addr == 192.168.1.1` - Show traffic to/from IP
- `tcp.port == 80` - Show HTTP traffic
- `dns` - Show DNS queries and responses

## Common Analysis Techniques

### TCP Analysis

**Three-Way Handshake:**
1. SYN - Client initiates connection
2. SYN-ACK - Server acknowledges and responds
3. ACK - Client acknowledges, connection established

```
Client -> Server: [SYN] Seq=0
Server -> Client: [SYN, ACK] Seq=0 Ack=1
Client -> Server: [ACK] Seq=1 Ack=1
```

**Connection Issues:**
- **Retransmissions**: Look for `[TCP Retransmission]` flags
- **Duplicate ACKs**: Indicate packet loss
- **Window Size**: Monitor for flow control issues

### HTTP Analysis

**Request/Response Analysis:**
- Method (GET, POST, PUT, DELETE)
- Status codes (200, 404, 500)
- Headers and content analysis
- Response times

### DNS Troubleshooting

**Common DNS Issues:**
- Query timeouts
- NXDOMAIN responses
- Incorrect A/AAAA records
- DNS cache poisoning attempts

```
# DNS query example
dig @8.8.8.8 example.com A
```

## Advanced Filtering

### Logical Operators
- `and` / `&&` - Both conditions must be true
- `or` / `||` - Either condition can be true
- `not` / `!` - Negates the condition

### Time-based Filters
- `frame.time >= "2024-01-01 00:00:00"`
- `frame.time_delta > 1` - Frames with >1 second delay

### Protocol-specific Filters
- `http.request.method == "POST"`
- `tcp.flags.syn == 1`
- `icmp.type == 8` - ICMP echo requests

## Performance Analysis

### Identifying Bottlenecks

1. **Response Time Analysis**
   - Use `Statistics > Service Response Time`
   - Look for high latency connections

2. **Throughput Analysis**
   - `Statistics > IO Graphs`
   - Monitor bandwidth utilization

3. **Expert Information**
   - `Analyze > Expert Information`
   - Automated problem detection

### Network Latency

**Round Trip Time (RTT):**
- Measure time between request and response
- Identify network vs application delays
- Use TCP stream analysis

## Security Analysis

### Detecting Suspicious Activity

**Port Scanning Detection:**
- Multiple SYN packets to different ports
- RST responses from closed ports
- Pattern recognition in connection attempts

**Data Exfiltration:**
- Unusual outbound traffic patterns
- Large file transfers
- Encrypted tunnels over HTTP

### Protocol Anomalies
- Malformed packets
- Unusual header values
- Protocol violations

## Best Practices

### Capture Strategy
1. **Targeted Captures**: Use filters to reduce file size
2. **Ring Buffers**: For continuous monitoring
3. **Multiple Files**: Split large captures
4. **Secure Storage**: Protect sensitive packet data

### Analysis Workflow
1. **Overview**: Get general traffic patterns
2. **Filter**: Focus on relevant traffic
3. **Follow Streams**: Analyze complete conversations
4. **Statistics**: Use built-in analysis tools
5. **Export**: Save relevant data for reporting

## Useful Keyboard Shortcuts

- `Ctrl+F` - Find packets
- `Ctrl+G` - Go to packet number
- `Ctrl+R` - Reload capture file
- `F8` - Step to next packet in stream
- `F7` - Step to previous packet in stream

## Common Use Cases

1. **Network Troubleshooting**: Identify connectivity issues
2. **Performance Analysis**: Find bottlenecks and delays
3. **Security Investigation**: Analyze suspicious traffic
4. **Protocol Development**: Debug custom protocols
5. **Compliance**: Monitor network communications

Wireshark is an incredibly powerful tool that becomes more valuable with practice. Start with simple captures and gradually work up to more complex analysis scenarios.
